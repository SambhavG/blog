import{n as ae,i as Mi,l as Si,s as zi,a as pa,o as Fi,e as Qo,b as _e,r as Vi,m as xi}from"./scheduler.CJ7dzQvO.js";import{C as Hi,D as Ni,E as Ri,F as Oi,S as Ui,i as Wi,f as qi,h as ji,m as Gi,t as En,j as Tn,k as Yi,e as p,s as h,H as ia,v as S,G as Fl,o as O,c as u,g as _,a as f,n as ra,u as k,d as l,w as z,I as Vl,l as d,q as b,b as a,A as w,J as bl,x as ye,y as gi,r as wi,p as zl,K as Ai,L as Xi}from"./index.DW5F0Pto.js";import{e as ne,u as Di,d as Ji,f as Ki}from"./each.SBgiIwXk.js";import{M as $i,g as Qi,a as Zo}from"./mdsvex.3-VI8z4S.js";import{b as me}from"./paths.DiDHzGcR.js";import{c as Zi,f as ki,a as er}from"./index.D9MSNRax.js";const tr=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function lr(i,t,s,o){if(!t)return ae;const r=i.getBoundingClientRect();if(t.left===r.left&&t.right===r.right&&t.top===r.top&&t.bottom===r.bottom)return ae;const{delay:c=0,duration:m=300,easing:y=Mi,start:v=Hi()+c,end:g=v+m,tick:x=ae,css:C}=s(i,{from:t,to:r},o);let A=!0,T=!1,F;function Ce(){C&&(F=Ri(i,0,1,m,c,y,C)),c||(T=!0)}function X(){C&&Oi(i,F),A=!1}return Ni(ve=>{if(!T&&ve>=v&&(T=!0),T&&ve>=g&&(x(1,0),X()),!A)return!1;if(T){const oe=ve-v,ie=0+1*y(oe/m);x(ie,1-ie)}return!0}),Ce(),x(0,1),X}function sr(i){const t=getComputedStyle(i);if(t.position!=="absolute"&&t.position!=="fixed"){const{width:s,height:o}=t,r=i.getBoundingClientRect();i.style.position="absolute",i.style.width=s,i.style.height=o,Ei(i,r)}}function Ei(i,t){const s=i.getBoundingClientRect();if(t.left!==s.left||t.top!==s.top){const o=getComputedStyle(i),r=o.transform==="none"?"":o.transform;i.style.transform=`${r} translate(${t.left-s.left}px, ${t.top-s.top}px)`}}function nr(i,{from:t,to:s},o={}){const r=getComputedStyle(i),c=r.transform==="none"?"":r.transform,[m,y]=r.transformOrigin.split(" ").map(parseFloat),v=t.left+t.width*m/s.width-(s.left+m),g=t.top+t.height*y/s.height-(s.top+y),{delay:x=0,duration:C=T=>Math.sqrt(T)*120,easing:A=Zi}=o;return{delay:x,duration:Si(C)?C(Math.sqrt(v*v+g*g)):C,easing:A,css:(T,F)=>{const Ce=F*v,X=F*g,ve=T+F*t.width/s.width,oe=T+F*t.height/s.height;return`transform: ${c} translate(${Ce}px, ${X}px) scale(${ve}, ${oe});`}}}const{Map:Ti}=tr;function ei(i,t,s){const o=i.slice();return o[33]=t[s],o}function ti(i,t,s){const o=i.slice();return o[36]=t[s][0],o[37]=t[s][1],o}function li(i,t,s){const o=i.slice();return o[40]=t[s],o}function si(i,t,s){const o=i.slice();o[43]=t[s],o[46]=s;const r=o[12](o[43].name);return o[44]=r,o}function ni(i,t,s){const o=i.slice();return o[47]=t[s],o}function ca(i){const t=i.slice(),s=mr(t[47].reg);return t[50]=s,t}function ai(i,t,s){const o=i.slice();o[51]=t[s],o[46]=s;const r=7+o[46]*2.9;o[52]=r;const c=o[5].get(o[51])??0;o[53]=c;const m=16+o[53]/16*180;return o[54]=m,o}function ar(i,t,s){const o=i.slice();return o[56]=t[s],o}function or(i){let t,s;return{c(){t=Fl("text"),s=S(i[56]),this.h()},l(o){t=Vl(o,"text",{x:!0,y:!0,fill:!0,"font-size":!0,"font-family":!0,"text-anchor":!0});var r=k(t);s=z(r,i[56]),r.forEach(l),this.h()},h(){d(t,"x",16+i[56]/16*180),d(t,"y","3.5"),d(t,"fill","#4b5563"),d(t,"font-size","3"),d(t,"font-family","monospace"),d(t,"text-anchor","middle")},m(o,r){a(o,t,r),w(t,s)},p:ae,d(o){o&&l(t)}}}function oi(i){let t,s=i[51]+"",o,r,c,m;return{c(){t=Fl("text"),o=S(s),r=Fl("line"),c=Fl("circle"),this.h()},l(y){t=Vl(y,"text",{x:!0,y:!0,fill:!0,"font-size":!0,"font-family":!0});var v=k(t);o=z(v,s),v.forEach(l),r=Vl(y,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),k(r).forEach(l),c=Vl(y,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),k(c).forEach(l),this.h()},h(){d(t,"x","0"),d(t,"y",i[52]+1),d(t,"fill","#6b7280"),d(t,"font-size","2.8"),d(t,"font-family","monospace"),d(r,"x1","16"),d(r,"y1",i[52]),d(r,"x2","196"),d(r,"y2",i[52]),d(r,"stroke","#374151"),d(r,"stroke-width","0.4"),d(c,"cx",m=i[54]),d(c,"cy",i[52]),d(c,"r","1.4"),d(c,"fill","#3b82f6")},m(y,v){a(y,t,v),w(t,o),a(y,r,v),a(y,c,v)},p(y,v){v[0]&16&&s!==(s=y[51]+"")&&ye(o,s),v[0]&48&&m!==(m=y[54])&&d(c,"cx",m)},d(y){y&&(l(t),l(r),l(c))}}}function ii(i){let t,s="No instructions (Bubble/Pause)";return{c(){t=p("div"),t.textContent=s,this.h()},l(o){t=u(o,"DIV",{class:!0,"data-svelte-h":!0}),_(t)!=="svelte-1vh739g"&&(t.textContent=s),this.h()},h(){d(t,"class","text-gray-600 italic text-sm py-4 text-center")},m(o,r){a(o,t,r)},d(o){o&&l(t)}}}function ri(i){let t,s=i[40].label+"",o,r,c=[],m=new Ti,y,v=ne(i[7][i[40].key]);const g=x=>x[40].key+"-"+String(x[46]);for(let x=0;x<v.length;x+=1){let C=si(i,v,x),A=g(C);m.set(A,c[x]=yi(A,C))}return{c(){t=p("div"),o=S(s),r=h();for(let x=0;x<c.length;x+=1)c[x].c();y=O(),this.h()},l(x){t=u(x,"DIV",{style:!0});var C=k(t);o=z(C,s),C.forEach(l),r=f(x);for(let A=0;A<c.length;A+=1)c[A].l(x);y=O(),this.h()},h(){b(t,"color","#6b7280"),b(t,"font-size","9px"),b(t,"font-weight","700"),b(t,"text-transform","uppercase"),b(t,"letter-spacing","0.05em"),b(t,"padding","4px 0 2px"),b(t,"margin-top","4px")},m(x,C){a(x,t,C),w(t,o),a(x,r,C);for(let A=0;A<c.length;A+=1)c[A]&&c[A].m(x,C);a(x,y,C)},p(x,C){C[0]&7296&&(v=ne(x[7][x[40].key]),c=Di(c,C,g,1,x,v,m,y.parentNode,Ji,yi,y,si))},d(x){x&&(l(t),l(r),l(y));for(let C=0;C<c.length;C+=1)c[C].d(x)}}}function ci(i){let t,s=i[44].batchPrefix+"",o;return{c(){t=p("span"),o=S(s),this.h()},l(r){t=u(r,"SPAN",{style:!0});var c=k(t);o=z(c,s),c.forEach(l),this.h()},h(){b(t,"color","#60a5fa"),b(t,"font-weight","700"),b(t,"flex-shrink","0")},m(r,c){a(r,t,c),w(t,o)},p(r,c){c[0]&128&&s!==(s=r[44].batchPrefix+"")&&ye(o,s)},d(r){r&&l(t)}}}function ir(i){let t,s,o,r,c,m=i[47].prefix&&pi(i),y=i[47].reg&&ui(ca(i)),v=i[47].suffix&&hi(i),g=i[47].symbol&&fi(i),x=i[47].literal!==void 0&&di(i);return{c(){m&&m.c(),t=O(),y&&y.c(),s=O(),v&&v.c(),o=O(),g&&g.c(),r=O(),x&&x.c(),c=O()},l(C){m&&m.l(C),t=O(),y&&y.l(C),s=O(),v&&v.l(C),o=O(),g&&g.l(C),r=O(),x&&x.l(C),c=O()},m(C,A){m&&m.m(C,A),a(C,t,A),y&&y.m(C,A),a(C,s,A),v&&v.m(C,A),a(C,o,A),g&&g.m(C,A),a(C,r,A),x&&x.m(C,A),a(C,c,A)},p(C,A){C[47].prefix?m?m.p(C,A):(m=pi(C),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),C[47].reg?y?y.p(ca(C),A):(y=ui(ca(C)),y.c(),y.m(s.parentNode,s)):y&&(y.d(1),y=null),C[47].suffix?v?v.p(C,A):(v=hi(C),v.c(),v.m(o.parentNode,o)):v&&(v.d(1),v=null),C[47].symbol?g?g.p(C,A):(g=fi(C),g.c(),g.m(r.parentNode,r)):g&&(g.d(1),g=null),C[47].literal!==void 0?x?x.p(C,A):(x=di(C),x.c(),x.m(c.parentNode,c)):x&&(x.d(1),x=null)},d(C){C&&(l(t),l(s),l(o),l(r),l(c)),m&&m.d(C),y&&y.d(C),v&&v.d(C),g&&g.d(C),x&&x.d(C)}}}function rr(i){let t,s=i[47].textOnly+"",o;return{c(){t=p("span"),o=S(s),this.h()},l(r){t=u(r,"SPAN",{style:!0});var c=k(t);o=z(c,s),c.forEach(l),this.h()},h(){b(t,"color","#6b7280")},m(r,c){a(r,t,c),w(t,o)},p(r,c){c[0]&128&&s!==(s=r[47].textOnly+"")&&ye(o,s)},d(r){r&&l(t)}}}function pi(i){let t,s=i[47].prefix+"",o;return{c(){t=p("span"),o=S(s),this.h()},l(r){t=u(r,"SPAN",{style:!0});var c=k(t);o=z(c,s),c.forEach(l),this.h()},h(){b(t,"color","#6b7280")},m(r,c){a(r,t,c),w(t,o)},p(r,c){c[0]&128&&s!==(s=r[47].prefix+"")&&ye(o,s)},d(r){r&&l(t)}}}function ui(i){let t,s=ha(i[47].reg,i[50])+"",o,r,c;return{c(){t=p("span"),o=S(s),this.h()},l(m){t=u(m,"SPAN",{class:!0,style:!0,title:!0});var y=k(t);o=z(y,s),y.forEach(l),this.h()},h(){d(t,"class","reg-pill"),d(t,"style",r=i[10](i[50])+"; padding: 1px 5px; border-radius: 9999px; font-weight: 500; font-size: 10px;"),d(t,"title",c=i[47].reg)},m(m,y){a(m,t,y),w(t,o)},p(m,y){y[0]&128&&s!==(s=ha(m[47].reg,m[50])+"")&&ye(o,s),y[0]&128&&r!==(r=m[10](m[50])+"; padding: 1px 5px; border-radius: 9999px; font-weight: 500; font-size: 10px;")&&d(t,"style",r),y[0]&128&&c!==(c=m[47].reg)&&d(t,"title",c)},d(m){m&&l(t)}}}function hi(i){let t,s=i[47].suffix+"",o;return{c(){t=p("span"),o=S(s),this.h()},l(r){t=u(r,"SPAN",{style:!0});var c=k(t);o=z(c,s),c.forEach(l),this.h()},h(){b(t,"color","#6b7280")},m(r,c){a(r,t,c),w(t,o)},p(r,c){c[0]&128&&s!==(s=r[47].suffix+"")&&ye(o,s)},d(r){r&&l(t)}}}function fi(i){let t,s=i[47].symbol+"",o;return{c(){t=p("span"),o=S(s),this.h()},l(r){t=u(r,"SPAN",{style:!0,class:!0});var c=k(t);o=z(c,s),c.forEach(l),this.h()},h(){b(t,"color","#9ca3af"),d(t,"class","select-none")},m(r,c){a(r,t,c),w(t,o)},p(r,c){c[0]&128&&s!==(s=r[47].symbol+"")&&ye(o,s)},d(r){r&&l(t)}}}function di(i){let t,s=i[47].literal+"",o;return{c(){t=p("span"),o=S(s),this.h()},l(r){t=u(r,"SPAN",{style:!0});var c=k(t);o=z(c,s),c.forEach(l),this.h()},h(){d(t,"style",i[11]())},m(r,c){a(r,t,c),w(t,o)},p(r,c){c[0]&128&&s!==(s=r[47].literal+"")&&ye(o,s)},d(r){r&&l(t)}}}function mi(i){let t;function s(c,m){return c[47].textOnly?rr:ir}let o=s(i),r=o(i);return{c(){r.c(),t=O()},l(c){r.l(c),t=O()},m(c,m){r.m(c,m),a(c,t,m)},p(c,m){o===(o=s(c))&&r?r.p(c,m):(r.d(1),r=o(c),r&&(r.c(),r.m(t.parentNode,t)))},d(c){c&&l(t),r.d(c)}}}function yi(i,t){let s,o,r,c,m=t[44].batchPrefix&&ci(t),y=ne(t[44].lines),v=[];for(let g=0;g<y.length;g+=1)v[g]=mi(ni(t,y,g));return{key:i,first:null,c(){s=p("div"),m&&m.c(),o=h();for(let g=0;g<v.length;g+=1)v[g].c();r=h(),this.h()},l(g){s=u(g,"DIV",{class:!0,style:!0});var x=k(s);m&&m.l(x),o=f(x);for(let C=0;C<v.length;C+=1)v[C].l(x);r=f(x),x.forEach(l),this.h()},h(){d(s,"class","instr-box"),b(s,"background-color","#1f2937"),b(s,"border","1px solid #4b5563"),b(s,"border-radius","6px"),b(s,"padding","3px 8px"),b(s,"margin-bottom","2px"),b(s,"box-shadow","0 1px 2px rgba(0,0,0,0.3)"),b(s,"white-space","nowrap"),b(s,"overflow","hidden"),b(s,"display","flex"),b(s,"align-items","center"),b(s,"gap","4px"),b(s,"font-size","11px"),this.first=s},m(g,x){a(g,s,x),m&&m.m(s,null),w(s,o);for(let C=0;C<v.length;C+=1)v[C]&&v[C].m(s,null);w(s,r)},p(g,x){if(t=g,t[44].batchPrefix?m?m.p(t,x):(m=ci(t),m.c(),m.m(s,o)):m&&(m.d(1),m=null),x[0]&7296){y=ne(t[44].lines);let C;for(C=0;C<y.length;C+=1){const A=ni(t,y,C);v[C]?v[C].p(A,x):(v[C]=mi(A),v[C].c(),v[C].m(s,r))}for(;C<v.length;C+=1)v[C].d(1);v.length=y.length}},i(g){g&&(c||xi(()=>{c=Ai(s,ki,{x:-20,duration:200}),c.start()}))},o:ae,d(g){g&&l(s),m&&m.d(),zl(v,g)}}}function Ci(i){let t,s=i[7][i[40].key].length>0&&ri(i);return{c(){s&&s.c(),t=O()},l(o){s&&s.l(o),t=O()},m(o,r){s&&s.m(o,r),a(o,t,r)},p(o,r){o[7][o[40].key].length>0?s?s.p(o,r):(s=ri(o),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(o){o&&l(t),s&&s.d(o)}}}function cr(i){let t,s=i[36]+"",o,r;return{c(){t=p("span"),o=S(s),r=h(),this.h()},l(c){t=u(c,"SPAN",{class:!0,style:!0});var m=k(t);o=z(m,s),r=f(m),m.forEach(l),this.h()},h(){d(t,"class","reg-pill"),d(t,"style",i[10](i[36])+"; padding: 2px 6px; border-radius: 9999px; display: inline-block;")},m(c,m){a(c,t,m),w(t,o),w(t,r)},p:ae,d(c){c&&l(t)}}}function vi(i){let t,s=i[36]!=="default"&&cr(i);return{c(){s&&s.c(),t=O()},l(o){s&&s.l(o),t=O()},m(o,r){s&&s.m(o,r),a(o,t,r)},p(o,r){o[36]!=="default"&&s.p(o,r)},d(o){o&&l(t),s&&s.d(o)}}}function pr(i){let t,s=[],o=new Ti,r,c=ne(i[3]);const m=y=>y[33].id;for(let y=0;y<c.length;y+=1){let v=ei(i,c,y),g=m(v);o.set(g,s[y]=bi(g,v))}return{c(){t=p("div");for(let y=0;y<s.length;y+=1)s[y].c();this.h()},l(y){t=u(y,"DIV",{style:!0});var v=k(t);for(let g=0;g<s.length;g+=1)s[g].l(v);v.forEach(l),this.h()},h(){b(t,"display","flex"),b(t,"flex-wrap","wrap"),b(t,"align-content","flex-start"),b(t,"gap","8px")},m(y,v){a(y,t,v);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(t,null);r=!0},p(y,v){if(v[0]&1032){c=ne(y[3]),gi();for(let g=0;g<s.length;g+=1)s[g].r();s=Di(s,v,m,1,y,c,o,t,Ki,bi,null,ei);for(let g=0;g<s.length;g+=1)s[g].a();wi()}},i(y){if(!r){for(let v=0;v<c.length;v+=1)En(s[v]);r=!0}},o(y){for(let v=0;v<s.length;v+=1)Tn(s[v]);r=!1},d(y){y&&l(t);for(let v=0;v<s.length;v+=1)s[v].d()}}}function ur(i){let t,s="No active registers";return{c(){t=p("div"),t.textContent=s,this.h()},l(o){t=u(o,"DIV",{class:!0,"data-svelte-h":!0}),_(t)!=="svelte-ljcwdx"&&(t.textContent=s),this.h()},h(){d(t,"class","flex items-center justify-center h-full text-gray-600")},m(o,r){a(o,t,r)},p:ae,i:ae,o:ae,d(o){o&&l(t)}}}function hr(i){let t,s="Loading Trace Data...";return{c(){t=p("div"),t.textContent=s,this.h()},l(o){t=u(o,"DIV",{class:!0,"data-svelte-h":!0}),_(t)!=="svelte-1t6rc8p"&&(t.textContent=s),this.h()},h(){d(t,"class","flex items-center justify-center h-full text-blue-400 animate-pulse")},m(o,r){a(o,t,r)},p:ae,i:ae,o:ae,d(o){o&&l(t)}}}function bi(i,t){let s,o=t[33].shortName+"",r,c,m,y,v,g,x,C=ae,A;return{key:i,first:null,c(){s=p("span"),r=S(o),c=h(),this.h()},l(T){s=u(T,"SPAN",{class:!0,style:!0,title:!0});var F=k(s);r=z(F,o),c=f(F),F.forEach(l),this.h()},h(){d(s,"class","reg-pill"),d(s,"style",m=t[10](t[33].type)+"; padding: 4px 8px; border-radius: 9999px; font-size: 10px; display: inline-block; box-shadow: 0 1px 2px rgba(0,0,0,0.2);"),d(s,"title",y=t[33].id),this.first=s},m(T,F){a(T,s,F),w(s,r),w(s,c),A=!0},p(T,F){t=T,(!A||F[0]&8)&&o!==(o=t[33].shortName+"")&&ye(r,o),(!A||F[0]&8&&m!==(m=t[10](t[33].type)+"; padding: 4px 8px; border-radius: 9999px; font-size: 10px; display: inline-block; box-shadow: 0 1px 2px rgba(0,0,0,0.2);"))&&d(s,"style",m),(!A||F[0]&8&&y!==(y=t[33].id))&&d(s,"title",y)},r(){x=s.getBoundingClientRect()},f(){sr(s),C(),Ei(s,x)},a(){C(),C=lr(s,x,nr,{duration:300})},i(T){A||(T&&xi(()=>{A&&(g&&g.end(1),v=Ai(s,ki,{y:10,duration:200}),v.start())}),A=!0)},o(T){v&&v.invalidate(),T&&(g=Xi(s,er,{duration:200})),A=!1},d(T){T&&l(s),T&&g&&g.end()}}}function fr(i){let t,s='I attempted <a href="https://github.com/anthropics/original_performance_takehome" rel="nofollow">Anthropic’s performance take-home exam</a> released recently. I achieved a final score of 1218 cycles, beating both the recruiting threshold (1487) and Opus 4.5’s best score (1363). <a href="https://github.com/SambhavG/anthropic-performance" rel="nofollow">My solution</a> is relatively simple and interpretable, combining a couple of basic theoretical and practical optimizations. Scroll to the bottom for a simulation of the solution in the form of my intermediate representation.',o,r,c="Contents",m,y,v='<li><a href="#problem-statement">Problem statement</a> <ul><li><a href="#the-processor">The Processor</a></li> <li><a href="#the-algorithm">The Algorithm</a></li></ul></li> <li><a href="#compute-and-memory-bounds">Compute and Memory Bounds</a> <ul><li><a href="#ops">Ops</a> <ul><li><a href="#aside-main-memory-indexing">Aside: Main Memory Indexing</a></li></ul></li> <li><a href="#memory">Memory</a> <ul><li><a href="#muxing">Muxing</a></li></ul></li></ul></li> <li><a href="#symbolic-intermediate-representation">Symbolic Intermediate Representation</a></li> <li><a href="#compiling">Compiling</a></li> <li><a href="#first-shot-2107-cycles">First Shot (2107 cycles)</a></li> <li><a href="#mux-level-0-1860-cycles">“Mux” Level 0 (1860 cycles)</a></li> <li><a href="#mux-level-1-1722-cycles">Mux Level 1 (1722 cycles)</a></li> <li><a href="#mux-level-2-1655-cycles">Mux Level 2 (1655 cycles)</a></li> <li><a href="#mux-level-3-1620-cycles-but-out-of-registers">Mux Level 3 (1620 cycles, but out of registers)</a></li> <li><a href="#mux-level-3-rotated-input-1548-cycles">Mux Level 3, Rotated Input (1548 cycles)</a></li> <li><a href="#optimize-preamble-1498-cycles">Optimize Preamble (1498 cycles)</a></li> <li><a href="#use-the-rest-of-the-alu-1240-cycles">Use the rest of the ALU (1240 cycles)</a></li> <li><a href="#optimize-tail-1218-cycles">Optimize Tail (1218 cycles)</a></li> <li><a href="#final-thoughts">Final thoughts</a></li>',g,x,C="Problem statement",A,T,F="The Processor",Ce,X,ve="You’re given a single instruction multiple data (SIMD) processor simulator. This processor can perform math operations on vectors of length 8.",oe,ie,Hl="The processor can perform up to 12 scalar ALU operations, 6 vectorized ALU operations, 2 loads, 2 stores, and a flow control operation all in one clock cycle, but no two instructions in the same cycle can read what the other writes.",_l,ke,Nl="There’s a RAM “scratch memory” of 1536 ordered registers, which is what the ALU and vector instructions can operate on. Vector instructions have to target 8 contiguous scalar registers. All the actual problem data starts on main memory, and must be loaded into scratch memory before it can be used.",Fe,xe,re="The Algorithm",xl,ge,Rl="The algorithm you’re asked to compute is as follows: you’re given a binary tree of height 10 (so the layers have 1, 2, 4, …, 2^10 nodes each, for 11 distinct layers and 2047 nodes total). Each node has a random integer value. You’re also given an array of input values, which has length batch_size=256. For each input value, you start at the top of the tree and xor your value with the top node’s value, then hash this new value with a given hash function. If your result is even, you take the left branch of the tree, otherwise you go right. You repeat this operation 16 times total, each time going down a level of the tree, and eventually looping around to the top node of the tree when you get to the last layer (which will always happen after round 11). This traversal is completely independent for each of the 256 input values.",gl,Ee,Ol="For the tree, we can compute child values using the tree indexing trick where the top node is at index 1 and every node x’s child is at index 2x and 2x+1 for left and right. Given this, there are three distinct phases to each of the 16 hops, given a current value v and index i (initialized to 1):",wl,Te,I="<li>Get the corresponding tree node i’s value v’ and xor it: v = v xor v’</li> <li>Hash v: v = hash(v)</li> <li>Compute the next index: i = 2i + (v%2), and if i&gt;2047, i = 1</li>",L,P,q="Notably, we’ll know at compile time when the loopback happens since we can compile our kernel for a specific testcase (where only the inner tree data is random but all the size parameters are fixed and known), so we don’t actually have to check this if statement in code (we can just directly set all the indices back to 1).",E,U,V="Compute and Memory Bounds",M,N,ce="Ops",Ve,le,K="The baseline code requires 147734 total instructions to compute the algorithm on the given test case. The baseline code only uses singular ALU ops and no SIMD/vectorization at all in any clock cycle. We’re only tested on this one specific test case, namely 256 inputs, height 10 tree, and 16 rounds, so we can overfit for convenience in this analysis.",$,Q,yt="The processor is capable of roughly 8x6+12 = 60 regular arithmetic operations per clock cycle, assuming that we always fuse vectorized multiplies and adds into a multiply_add.",Ul,Ct,fa="The initial xor with the value in the tree takes 1 op. The hash function mentioned earlier has 6 stages, each requiring 3 operations, and we have to do an additional xor at the beginning. However, it turns out the multiply_add can be used to crush three of those stages down to one operation each (these stages can be written as the sum of x, x shifted left by some amount, and a hardcoded number, which boils down to x times 2^n+1 plus c for some n and c), so we only need 12 ops for our hash. Computing the next node to hop to is a bit trickier and implementation-dependent, but we’ll assume for now it requires an & with 1 for the modulo check, a doubling of the old index pointer, and an addition of that 0 or 1 from the modulo check, so three more ALU ops. This is a total of 16 operations per batch item per round.",Wl,vt,da="Then for a batch size of 256 and 16 rounds, we’ll need 256x16x16=65536 operations, or roughly 1092 clock cycles for compute. Note that we’re allowed to load and store at the same time as our compute cycles, so this is a lower bound on performance possible assuming we compute exactly as described. Opus 4.5’s launch performance was 1487 cycles, and its best performance was 1363 cycles.",ql,He,ma="Aside: Main Memory Indexing",jl,bt,ya="The tree values in main memory start at address 7, meaning the first node is at main_mem[7].  We can only address main memory by putting the address we want in a scratch register and giving that scratch register as an argument. This means if we store indices with our regular 1-indexing, we’ll have to add 6 every time we want to fetch the tree values, and subtract 6 every time we want to compute the next index. We really want to avoid these extra ALU operations if possible.",Gl,_t,Ca="It turns out we can keep our indices in the 7-indexed scheme thanks to the vmultiply_add operation. Normally, we’d compute left_node = parent_node x 2, but if we instead store parent_node+6, we can compute left_node+6 = (parent_node+6) x 2 - 6. This means we can directly load from our index registers while still cheaply doubling node indices.",Yl,Ne,va="Memory",Xl,xt,ba="I initially wrote up a version of this problem where we try to load in as much of the tree as possible to scratch, then use those values throughout the problem. For the same reason earlier mentioned about main memory addressing, this is impossible - there are no instructions capable of double indirection into scratch memory. If we have a scratch address in a scratch register, we can’t actually dereference that scratch address and fetch or do math with the result. This means, for every round and value, we need to either:",Jl,gt,_a="<li>Fetch the required tree value straight from main memory, as the load instruction does allow (and in fact requires) double indirection.</li> <li>Do something clever using instructions like vectorized select to reduce the memory pressure, particularly on less complicated levels of the tree. For example, on level 0, all of the scratch values xor with the same tree value, so we can just load it to a register and reuse it for all the scratch values without any loading logic.</li>",Kl,wt,xa="If we go with idea 1 for every level of our tree, we’ll need 16 rounds of loads for each of the 256 values in our batch, and at 2 loads per cycle that’s at least 2048 cycles. Thanks to the specific test case design and the VSELECT instruction, there’s a lot we can do to match the memory and compute cost.",$l,Re,ga="Muxing",Ql,At,wa="(For this section, we’ll go back to assuming our indices are 1-indexed)",Zl,Dt,Aa="We want to replace memory operations with compute operations to balance out the workloads. On layer 0, as mentioned, we’ll just load the first tree value once and use it for every element.",es,kt,Da="On layers 1, 2, and 3, we need to load in only 2, 4, and 8 values respectively (unlike layer 10 where there’s as many as 1024 possible values we could be asked to load in, with likely little to no reuse among our 256 elements). To take advantage of these small layers, we can implement a MUX (multiplexing) tree, which attempts to efficiently convert the vector of indices [a,b,c,d,e,f,g,h] to a vector of [arr[a],arr[b],arr[c],arr[d],arr[e],arr[f],arr[g],arr[h]] by taking advantage of assumptions on the range of the values of the indices.",ts,Et,ka="For this, we’ll need the VSELECT instruction. VSELECT takes three vector registers we can call s, a, and b. VSELECT functions like an if-else statement on the condition of s. If index i of s is nonzero, the output register gets a[i] in slot i, otherwise it gets b[i].",ls,Tt,Ea="In the 2-value case, the mux tree is pretty easy. All our indices are either 2 or 3, so we & our index vector with 1 to get a vector of 0 or 1 based on if we need to xor that value with tree[2] (even) or tree[3] (odd). Now we set our output vector to the VSELECT of the vector of tree[2] and the vector of tree[3\\,] selecting on our &1 vector so that the even values (where there’s a 0) will get index 2 and the odd values will get index 3. Note that we broadcast our two tree values into full vector registers so that they are in the form required by the VSELECT instruction.",ss,Lt,Ta="In the 4-value case, we start building up the MUX tree. The idea is that we can VSELECT the bottom bit for each case of the top bit, then VSELECT those two cases together. We’re working with indices 4, 5, 6, and 7, with bottom bits 0b00, 0b01, 0b10, 0b11. First we VSELECT together tree[4] and tree[5] based on the bottom bits (so selecting via &1) - this puts the correct value in place for 0b00 and 0b01, but garbage value in place for 0b10, 0b11. Next, we VSELECT together tree[6] and tree[7] on the bottom bits into a separate register, which gives us the right values for 0b10 and 0b11 and garbage for the others. Finally, we &2 the indices to get the top bit, which tells VSELECT which register that index should pull its value from (while the other register will have a garbage value). This combines our two intermediate vectors into one final correct vector.",ns,Pt,La="We can build this tree up arbitrarily tall, but it will obviously cost more registers and compute if we do it later and later in the tree since we’ll have more and more values to mux together. Since there are 32 batches of 8 in our input, we’ll need 0, 32, 96, 224, and 480 VSELECTs for each round at level 0, 1, 2, 3, and 4 in the tree (and each of these levels appears twice). We only have on the order of 1000 total VSELECTS we can use since we only get one per cycle.",as,Bt,Pa="If we load all but levels 0-3 of the tree, we will load 8 levels of the tree and require 2048 loads, taking 1024 cycles. This will require 704 VSELECTs and a handful more vector ops, so resource consumption across the instruction types is now much more balanced.",os,Oe,Ba="Symbolic Intermediate Representation",is,It,Ia="We could try to orchestrate and fit the instructions to the CPU ourselves, but most likely this will create gaps that are difficult to manually handle. Instead, we’re going to write our code in an intermediate representation (a version of the program that operates on symbolic registers rather than real data or real scratch addresses), and then write a compiler pass that compresses and pipelines it automatically. This will also make it easier to take advantage of ALU operations later.",rs,Mt,Ma="The intermediate representation scheme we’ll write is relatively simple, but hits some quirks around loading and storing. It has two rough assumptions:",cs,St,Sa="<li>All registers are treated as 8-aligned vector registers</li> <li>Every instruction writes to a fresh register. The compiler will handle checking when a register can be “clobbered” ie written over due to nothing needing to read from it anymore.</li>",ps,zt,za="One exception is that loading the tree from indices requires 8 loads all to the same vector, because it only loads one scalar at a time, so the compiler will have to do some extra offset computations when lowering this instruction from IR to a real instruction.",us,Ft,Fa="With this and a bunch of small implementation details, we can write our entire computation in an IR form that doesn’t care what the input values are, as long as we’re careful to write each instruction correctly. A sample of these is shown below:",hs,Tl,Li=`<pre class="shiki poimandres" style="background-color:#1b1e28;color:#a6accd" tabindex="0"><code><span class="line"><span style="color:#A6ACCD">@</span><span style="color:#ADD7FF">dataclass</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">frozen</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">True</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#91B4D5">class</span><span style="color:#ADD7FF"> const_register</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    name: </span><span style="color:#A6ACCDC0">str</span></span>
<span class="line"><span style="color:#A6ACCD">    is_scalar: </span><span style="color:#A6ACCDC0">bool</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">@</span><span style="color:#ADD7FF">dataclass</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">frozen</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">True</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#91B4D5">class</span><span style="color:#ADD7FF"> index_register</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    batch_index: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"><span style="color:#A6ACCD">    round: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"><span style="color:#A6ACCD">    is_doubled: </span><span style="color:#A6ACCDC0">bool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">@</span><span style="color:#ADD7FF">dataclass</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">frozen</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">True</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#91B4D5">class</span><span style="color:#ADD7FF"> value_register</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    batch_index: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"><span style="color:#A6ACCD">    round: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"><span style="color:#A6ACCD">    stage: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">@</span><span style="color:#ADD7FF">dataclass</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">frozen</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">True</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#91B4D5">class</span><span style="color:#ADD7FF"> tree_address_register</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    batch_index: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"><span style="color:#A6ACCD">    round: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD">@</span><span style="color:#ADD7FF">dataclass</span><span style="color:#A6ACCD">(</span><span style="color:#E4F0FB">frozen</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">True</span><span style="color:#A6ACCD">)</span></span>
<span class="line"><span style="color:#91B4D5">class</span><span style="color:#ADD7FF"> tree_register</span><span style="color:#A6ACCD">:</span></span>
<span class="line"><span style="color:#A6ACCD">    batch_index: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"><span style="color:#A6ACCD">    round: </span><span style="color:#A6ACCDC0">int</span></span>
<span class="line"><span style="color:#A6ACCD">    slots_filled: </span><span style="color:#A6ACCDC0">int</span></span></code></pre>`,Ll,Vt,Va="Each IR instruction is a real operation, but written to operate on instantiations of these imaginary registers instead of a real scratch address. For example, when computing the first hash stage of a value, inside a double for loop that tells us which batch index and round we’re on:",fs,Pl,Pi=`<pre class="shiki poimandres" style="background-color:#1b1e28;color:#a6accd" tabindex="0"><code><span class="line"><span style="color:#767C9DB0;font-style:italic"># Hash stage 1</span></span>
<span class="line"><span style="color:#A6ACCD">instrs.append((</span></span>
<span class="line"><span style="color:#A6ACCD">	"</span><span style="color:#5DE4C7">valu</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">	"</span><span style="color:#5DE4C7">vmultiply_add</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">,</span></span>
<span class="line"><span style="color:#A6ACCD">	value_register(</span><span style="color:#E4F0FB">batch_index</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB">round</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB">stage</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">2</span><span style="color:#A6ACCD">),</span></span>
<span class="line"><span style="color:#A6ACCD">	value_register(</span><span style="color:#E4F0FB">batch_index</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB">round</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">,</span><span style="color:#E4F0FB">stage</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">1</span><span style="color:#A6ACCD">),</span></span>
<span class="line"><span style="color:#A6ACCD">	const_register(</span><span style="color:#E4F0FB">name</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">HASH_1_MUL</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">is_scalar</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">False</span><span style="color:#A6ACCD">),</span></span>
<span class="line"><span style="color:#A6ACCD">	const_register(</span><span style="color:#E4F0FB">name</span><span style="color:#91B4D5">=</span><span style="color:#A6ACCD">"</span><span style="color:#5DE4C7">HASH_1_ADD</span><span style="color:#A6ACCD">"</span><span style="color:#A6ACCD">, </span><span style="color:#E4F0FB">is_scalar</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">False</span><span style="color:#A6ACCD">),</span></span>
<span class="line"><span style="color:#A6ACCD">))</span></span></code></pre>`,Bl,Ht,Ha="The fresh register property mentioned earlier gives this IR code the really nice property that once we’ve emitted all our instructions, we can verify that they perform the correct computation by simulating the instructions on an infinite register machine that always allocates a fresh register on each write.",ds,Ue,Na="Compiling",ms,Nt,Ra="We’d now like our compiler to figure out how to pack our instructions into the given slots for us. With our IR, the first pass of this is pretty easy. We need to know which instructions depend on which so that each instruction that reads from scratch always has its desired inputs available. Any two instructions that have all their inputs available can be immediately scheduled.",ys,Rt,Oa="We can generate a dependency graph from our instructions, where we say A depends on B (B->A) if B writes a register that A reads. Once we’ve constructed this dependency graph, we can greedily grab sets of orphaned nodes from the graph (nodes with no parents, meaning all the registers are ready to use) and append them to the current cycle until we’re out of instructions or out of slots in the cycle. We can keep track of scratch registers at the same time, where any register that no longer has future readers will be evicted from the used scratch.",Cs,We,Ua="First Shot (2107 cycles)",vs,Ot,Wa="We’ll skip the mux tree for now and check that our compiler works from end to end.",bs,Ut,qa="As we expect, we’re underutilizing the vector ALU because of loads - almost exactly to the degree we expect, 2048 load cycles + extra overhead like loading constants and final stores.",_s,qe,ja,xs,je,Ga="“Mux” Level 0 (1860 cycles)",gs,Wt,Ya="We’ll now directly address level 0’s one node as a constant. Now all six VALU lanes are fully utilized for the first ~200 cycles and again later on (once we’ve looped back around to level 0) for another 200 cycles.",ws,qt,Xa="Those 200 cycles, zoomed in:",As,Ge,Ja,Ds,jt,Ka="The entire trace, with the second set of 200 cycles highlighted:",ks,Ye,$a,Es,Xe,Qa="Mux Level 1 (1722 cycles)",Ts,Gt,Za="Because of our indexing optimization, we have to be a little careful how we mux, but thankfully just by shuffling the two outputs in each VSELECT we can assign the mux outputs however we want (as long as the input index range is contiguous, so that their bottom bits uniquely define them).",Ls,Je,eo,Ps,Ke,to="Mux Level 2 (1655 cycles)",Bs,Yt,lo="The speedups are starting to stall, likely because our compiler isn’t smart enough to rush through one of the batches so it can get to the load-heavy batches and start running the load bottleneck. We have load bubbles of roughly 300 cycles.",Is,$e,so,Ms,Qe,no="Mux Level 3 (1620 cycles, but out of registers)",Ss,Xt,ao="In addition to adding mux level 3, I went back and optimized the logic for mux 1 and 2 (mainly reusing the value&1 computed in the previous iteration). Not only are we losing our speedups, we also can’t actually run the code without at least 1900 registers.",zs,Jt,oo="This is mainly because of bigger and bigger bubbles in loading; our compiler isn’t smart enough to rush to the bounded loading steps. We’re running out of registers because our compiler schedules all the heavy mux level 3 operations at once among all the batches, and they consume a lot of extra registers before they can be freed.",Fs,Ze,io,Vs,et,ro="Mux Level 3, Rotated Input (1548 cycles)",Hs,Kt,co="We can sidestep this problem really simply - we just need to write our input in a way that doesn’t clog up the registers when everyone gets to muxing level 3. We do this by emitting instructions for all rounds of batch 1, then all rounds of batch 2, etc. instead of all round 1s, all round 2s, etc. By doing this, not only do we no longer run out of registers, but we also smear the computation much more evenly through the middle - the big bubble in the fifth and sixth lane is completely gone.",Ns,$t,po="This is not a scientific result, but a fairly lucky coincidence that manages to spread out the mux level 3 enough to keep our registers open. It saves us a lot of time redesigning the compiler.",Rs,Qt,uo="The coloring changed because I updated the labeling to use the names of the IR registers instead of the true underlying register indices.",Os,tt,ho,Us,lt,fo="Optimize Preamble (1498 cycles)",Ws,Zt,mo="Right now we load_const all our constants, which clogs up the preamble quite a bit with a stuffed load unit. A good chunk of our constants can be computed directly from other constants, like HASH_6_RIGHTSHIFT with the value 16 that can be computed as 4x4.",qs,el,yo="We can also start using the ALU earlier. Our code doesn’t do hotpath analysis, so it takes a bit of loading before the ALU can start crunching. Just by moving the loading of tree node 0 a little earlier, we can start the ALU much sooner and overlap it with the last few loads needed for later stages.",js,tl,Co="Before:",Gs,st,vo,Ys,ll,bo="After:",Xs,nt,_o,Js,at,xo="Use the rest of the ALU (1240 cycles)",Ks,sl,go="We have 12 ALU operations unused. The first 8 are easy to use - any vector ALU op that isn’t a broadcast operation or vmultiply_add operation can be split into 8 of the same scalar operation with the register indices updated.",$s,nl,wo="For the last 4 slots, we have to be a little smarter. We can schedule half of a vector instruction by turning the first 4 slots into ALU ops, but leave it on the graph and mark it as half done instead of fully done. We’ll prioritize scheduling the other half of these vector instructions on the next cycle’s ALU so that the vector is half-done for only one cycle.",Qs,al,Ao="This predictably gives us a huge performance jump, as we go from 6 to 7.5 vector ALU ops per cycle. Naively, this should give us at most a 25% performance increase, which would ideally put us at ~1200 cycles, but obviously there’s some non-ALU overhead. This also puts us ahead of Claude’s best performance.",Zs,ot,Do,en,it,ko="Optimize Tail (1218 cycles)",tn,ol,Eo="While the aforementioned input rotation is great for fixing the register problem, it creates a long tail of inputs that poorly utilize the compute at the end, as there aren’t enough batch elements to parallelize (manifesting as a staircase pattern). We can slightly improve on this by adding the last four batches in the original order, round-by-round, so that there will be more parallel work at any given moment near the end.",ln,il,To="We again get lucky with no register outage, likely thanks to (1) the previous batches creating a long tail for our instructions to fill in which smears the extra VSELECT registers, and (2) the new batches we scheduled not being large enough to exert too much register pressure. We pick the last four batches because they achieve the best performance.",sn,rt,Lo,nn,ct,Po="Final thoughts",an,rl,Bo="There’s quite a lot more compiler optimization work here that could be done, but given I’m approaching my own theoretical lower bound, I think these returns will be quickly diminishing. These efforts would mainly go towards trying to solve for the best packing, through things like hot path analysis to avoid the remaining tail at the end and smarter register allocation. We do some manual shuffling of instructions in the preamble that we’d really prefer the compiler figure out for us, and we would rather our compiler be agnostic to the rotation and exact instruction stream order of the IR.",on,cl,Io="There’s about 80 cycles of load bubbles left, which if further optimized would get us within a few percent of the ALU lower bound mentioned earlier. Under the current compute graph this may not be possible with limited remaining ALU room, but there’s plenty of other inefficiencies in the loading operations (namely in loading addresses for main memory) I didn’t work on because it would’ve required significant updates to the IR scheme.",rn,pl,Mo="I achieved a final score of 1218 cycles, which I’m pretty happy with. I ran it on the commented-out test case on different args to show we didn’t overfit to the main test case and actually get even better relative speedups on smaller test cases:",cn,Il,Bi=`<pre class="shiki poimandres" style="background-color:#1b1e28;color:#a6accd" tabindex="0"><code><span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">2</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">4</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">128</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">156</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">947.0128205128206</span></span>
<span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">3</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">5</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">128</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">233</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">634.0515021459228</span></span>
<span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">4</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">6</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">128</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">251</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">588.5816733067729</span></span>
<span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">2</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">4</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">256</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">284</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">520.1901408450705</span></span>
<span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">3</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">5</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">256</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">419</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">352.5871121718377</span></span>
<span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">4</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">6</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">256</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">462</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">319.7705627705628</span></span>
<span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">10</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">16</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">256</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">1218</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">121.29228243021346</span></span>
<span class="line"><span style="color:#A6ACCD">forest_height</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">10</span><span style="color:#A6ACCD">, rounds</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">16</span><span style="color:#A6ACCD">, batch_size</span><span style="color:#91B4D5">=</span><span style="color:#5DE4C7">256</span></span>
<span class="line"><span style="color:#A6ACCD">CYCLES:  </span><span style="color:#5DE4C7">1218</span></span>
<span class="line"><span style="color:#A6ACCD">Speedup over baseline:  </span><span style="color:#5DE4C7">121.29228243021346</span></span></code></pre>`,Ml,ul,So="Below is a simulator that shows the entire computation being performed in my IR cycle-by-cycle.",pn,Le,we,hl,zo=`<h2 class="text-xl font-bold text-gray-100 flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-green-500 animate-pulse"></span>
        IR Processor Trace</h2>`,Ln,J,se,Pn,te,Bn,W,In,R,Pe,Mn,un,Sn,Be,zn,hn,Fn,Ie,Vn,fn,Hn,Ae,Al,dn,fl,Nn,mn,Rn,Me,On,yn,Un,Se,Wn,Cn,qn,ze,jn,vn,Gn,pt,pe,dl,Fo="Batch Progress",Yn,ml,ue,Xn,Jn,yl,Vo="Instructions Executing",Kn,De,bn,$n,ut,ht,ft,Qn,Sl=i[3].length+"",_n,Zn,ea,be,ta,Cl,he,fe,xn,vl,Ho=`/* Custom Scrollbar for dark theme */
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }
  .custom-scrollbar::-webkit-scrollbar-track {
    background: #111827; 
  }
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: #374151; 
    border-radius: 3px;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #4b5563; 
  }

  .btn {
    @apply px-3 py-1 bg-gray-800 hover:bg-gray-700 text-gray-200 text-xs font-semibold rounded border border-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .reg-pill {
    white-space: nowrap;
  }`,j,la,No,Ii=ne([0,4,8,12,16]),Dl=[];for(let e=0;e<5;e+=1)Dl[e]=or(ar(i,Ii,e));let kl=ne(i[4]),G=[];for(let e=0;e<kl.length;e+=1)G[e]=oi(ai(i,kl,e));let Z=i[7].aluValu.length===0&&i[7].load.length===0&&i[7].store.length===0&&i[7].vselect.length===0&&ii(),sa=ne([{key:"aluValu",label:"ALU / VALU"},{key:"load",label:"LOAD"},{key:"store",label:"STORE"},{key:"vselect",label:"VSELECT"}]),de=[];for(let e=0;e<4;e+=1)de[e]=Ci(li(i,sa,e));let El=ne(Object.entries(i[9])),Y=[];for(let e=0;e<El.length;e+=1)Y[e]=vi(ti(i,El,e));const Ro=[hr,ur,pr],dt=[];function Oo(e,n){return e[2]?0:e[3].length===0?1:2}return he=Oo(i),fe=dt[he]=Ro[he](i),{c(){t=p("p"),t.innerHTML=s,o=h(),r=p("h2"),r.textContent=c,m=h(),y=p("ul"),y.innerHTML=v,g=h(),x=p("h1"),x.textContent=C,A=h(),T=p("h2"),T.textContent=F,Ce=h(),X=p("p"),X.textContent=ve,oe=h(),ie=p("p"),ie.textContent=Hl,_l=h(),ke=p("p"),ke.textContent=Nl,Fe=h(),xe=p("h2"),xe.textContent=re,xl=h(),ge=p("p"),ge.textContent=Rl,gl=h(),Ee=p("p"),Ee.textContent=Ol,wl=h(),Te=p("ol"),Te.innerHTML=I,L=h(),P=p("p"),P.textContent=q,E=h(),U=p("h1"),U.textContent=V,M=h(),N=p("h2"),N.textContent=ce,Ve=h(),le=p("p"),le.textContent=K,$=h(),Q=p("p"),Q.textContent=yt,Ul=h(),Ct=p("p"),Ct.textContent=fa,Wl=h(),vt=p("p"),vt.textContent=da,ql=h(),He=p("h3"),He.textContent=ma,jl=h(),bt=p("p"),bt.textContent=ya,Gl=h(),_t=p("p"),_t.textContent=Ca,Yl=h(),Ne=p("h2"),Ne.textContent=va,Xl=h(),xt=p("p"),xt.textContent=ba,Jl=h(),gt=p("ol"),gt.innerHTML=_a,Kl=h(),wt=p("p"),wt.textContent=xa,$l=h(),Re=p("h3"),Re.textContent=ga,Ql=h(),At=p("p"),At.textContent=wa,Zl=h(),Dt=p("p"),Dt.textContent=Aa,es=h(),kt=p("p"),kt.textContent=Da,ts=h(),Et=p("p"),Et.textContent=ka,ls=h(),Tt=p("p"),Tt.textContent=Ea,ss=h(),Lt=p("p"),Lt.textContent=Ta,ns=h(),Pt=p("p"),Pt.textContent=La,as=h(),Bt=p("p"),Bt.textContent=Pa,os=h(),Oe=p("h1"),Oe.textContent=Ba,is=h(),It=p("p"),It.textContent=Ia,rs=h(),Mt=p("p"),Mt.textContent=Ma,cs=h(),St=p("ol"),St.innerHTML=Sa,ps=h(),zt=p("p"),zt.textContent=za,us=h(),Ft=p("p"),Ft.textContent=Fa,hs=h(),Tl=new ia(!1),Ll=h(),Vt=p("p"),Vt.textContent=Va,fs=h(),Pl=new ia(!1),Bl=h(),Ht=p("p"),Ht.textContent=Ha,ds=h(),Ue=p("h1"),Ue.textContent=Na,ms=h(),Nt=p("p"),Nt.textContent=Ra,ys=h(),Rt=p("p"),Rt.textContent=Oa,Cs=h(),We=p("h1"),We.textContent=Ua,vs=h(),Ot=p("p"),Ot.textContent=Wa,bs=h(),Ut=p("p"),Ut.textContent=qa,_s=h(),qe=p("img"),xs=h(),je=p("h1"),je.textContent=Ga,gs=h(),Wt=p("p"),Wt.textContent=Ya,ws=h(),qt=p("p"),qt.textContent=Xa,As=h(),Ge=p("img"),Ds=h(),jt=p("p"),jt.textContent=Ka,ks=h(),Ye=p("img"),Es=h(),Xe=p("h1"),Xe.textContent=Qa,Ts=h(),Gt=p("p"),Gt.textContent=Za,Ls=h(),Je=p("img"),Ps=h(),Ke=p("h1"),Ke.textContent=to,Bs=h(),Yt=p("p"),Yt.textContent=lo,Is=h(),$e=p("img"),Ms=h(),Qe=p("h1"),Qe.textContent=no,Ss=h(),Xt=p("p"),Xt.textContent=ao,zs=h(),Jt=p("p"),Jt.textContent=oo,Fs=h(),Ze=p("img"),Vs=h(),et=p("h1"),et.textContent=ro,Hs=h(),Kt=p("p"),Kt.textContent=co,Ns=h(),$t=p("p"),$t.textContent=po,Rs=h(),Qt=p("p"),Qt.textContent=uo,Os=h(),tt=p("img"),Us=h(),lt=p("h1"),lt.textContent=fo,Ws=h(),Zt=p("p"),Zt.textContent=mo,qs=h(),el=p("p"),el.textContent=yo,js=h(),tl=p("p"),tl.textContent=Co,Gs=h(),st=p("img"),Ys=h(),ll=p("p"),ll.textContent=bo,Xs=h(),nt=p("img"),Js=h(),at=p("h1"),at.textContent=xo,Ks=h(),sl=p("p"),sl.textContent=go,$s=h(),nl=p("p"),nl.textContent=wo,Qs=h(),al=p("p"),al.textContent=Ao,Zs=h(),ot=p("img"),en=h(),it=p("h1"),it.textContent=ko,tn=h(),ol=p("p"),ol.textContent=Eo,ln=h(),il=p("p"),il.textContent=To,sn=h(),rt=p("img"),nn=h(),ct=p("h1"),ct.textContent=Po,an=h(),rl=p("p"),rl.textContent=Bo,on=h(),cl=p("p"),cl.textContent=Io,rn=h(),pl=p("p"),pl.textContent=Mo,cn=h(),Il=new ia(!1),Ml=h(),ul=p("p"),ul.textContent=So,pn=h(),Le=p("div"),we=p("div"),hl=p("div"),hl.innerHTML=zo,Ln=h(),J=p("div"),se=p("div"),Pn=h(),te=p("div"),Bn=h(),W=p("input"),In=h(),R=p("div"),Pe=p("button"),Mn=S("‹‹‹"),Sn=h(),Be=p("button"),zn=S("‹‹"),Fn=h(),Ie=p("button"),Vn=S("‹"),Hn=h(),Ae=p("div"),Al=p("span"),dn=S(i[1]),fl=p("span"),Nn=S("/ "),mn=S(i[0]),Rn=h(),Me=p("button"),On=S("›"),Un=h(),Se=p("button"),Wn=S("››"),qn=h(),ze=p("button"),jn=S("›››"),Gn=h(),pt=p("div"),pe=p("div"),dl=p("h3"),dl.textContent=Fo,Yn=h(),ml=p("div"),ue=Fl("svg");for(let e=0;e<5;e+=1)Dl[e].c();Xn=O();for(let e=0;e<G.length;e+=1)G[e].c();Jn=h(),yl=p("h3"),yl.textContent=Vo,Kn=h(),De=p("div"),Z&&Z.c(),bn=h();for(let e=0;e<4;e+=1)de[e].c();$n=h(),ut=p("div"),ht=p("div"),ft=p("h3"),Qn=S("Live Registers ("),_n=S(Sl),Zn=S(")"),ea=h(),be=p("div");for(let e=0;e<Y.length;e+=1)Y[e].c();ta=h(),Cl=p("div"),fe.c(),xn=h(),vl=p("style"),vl.textContent=Ho,this.h()},l(e){t=u(e,"P",{"data-svelte-h":!0}),_(t)!=="svelte-1rowf0r"&&(t.innerHTML=s),o=f(e),r=u(e,"H2",{id:!0,"data-svelte-h":!0}),_(r)!=="svelte-mkui86"&&(r.textContent=c),m=f(e),y=u(e,"UL",{"data-svelte-h":!0}),_(y)!=="svelte-1xmidpa"&&(y.innerHTML=v),g=f(e),x=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(x)!=="svelte-1hoea67"&&(x.textContent=C),A=f(e),T=u(e,"H2",{id:!0,"data-svelte-h":!0}),_(T)!=="svelte-4ydllv"&&(T.textContent=F),Ce=f(e),X=u(e,"P",{"data-svelte-h":!0}),_(X)!=="svelte-4g044a"&&(X.textContent=ve),oe=f(e),ie=u(e,"P",{"data-svelte-h":!0}),_(ie)!=="svelte-1xo5n0d"&&(ie.textContent=Hl),_l=f(e),ke=u(e,"P",{"data-svelte-h":!0}),_(ke)!=="svelte-17nez0u"&&(ke.textContent=Nl),Fe=f(e),xe=u(e,"H2",{id:!0,"data-svelte-h":!0}),_(xe)!=="svelte-19y3thh"&&(xe.textContent=re),xl=f(e),ge=u(e,"P",{"data-svelte-h":!0}),_(ge)!=="svelte-145ir2o"&&(ge.textContent=Rl),gl=f(e),Ee=u(e,"P",{"data-svelte-h":!0}),_(Ee)!=="svelte-17g7mb2"&&(Ee.textContent=Ol),wl=f(e),Te=u(e,"OL",{"data-svelte-h":!0}),_(Te)!=="svelte-pa9qgq"&&(Te.innerHTML=I),L=f(e),P=u(e,"P",{"data-svelte-h":!0}),_(P)!=="svelte-1pkha98"&&(P.textContent=q),E=f(e),U=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(U)!=="svelte-9eue7d"&&(U.textContent=V),M=f(e),N=u(e,"H2",{id:!0,"data-svelte-h":!0}),_(N)!=="svelte-mozfji"&&(N.textContent=ce),Ve=f(e),le=u(e,"P",{"data-svelte-h":!0}),_(le)!=="svelte-utpxyc"&&(le.textContent=K),$=f(e),Q=u(e,"P",{"data-svelte-h":!0}),_(Q)!=="svelte-1lgfz2v"&&(Q.textContent=yt),Ul=f(e),Ct=u(e,"P",{"data-svelte-h":!0}),_(Ct)!=="svelte-1p88lt9"&&(Ct.textContent=fa),Wl=f(e),vt=u(e,"P",{"data-svelte-h":!0}),_(vt)!=="svelte-imp4iq"&&(vt.textContent=da),ql=f(e),He=u(e,"H3",{id:!0,"data-svelte-h":!0}),_(He)!=="svelte-s49ez1"&&(He.textContent=ma),jl=f(e),bt=u(e,"P",{"data-svelte-h":!0}),_(bt)!=="svelte-gkqa2r"&&(bt.textContent=ya),Gl=f(e),_t=u(e,"P",{"data-svelte-h":!0}),_(_t)!=="svelte-xha2vt"&&(_t.textContent=Ca),Yl=f(e),Ne=u(e,"H2",{id:!0,"data-svelte-h":!0}),_(Ne)!=="svelte-9bafq"&&(Ne.textContent=va),Xl=f(e),xt=u(e,"P",{"data-svelte-h":!0}),_(xt)!=="svelte-11yl1g"&&(xt.textContent=ba),Jl=f(e),gt=u(e,"OL",{"data-svelte-h":!0}),_(gt)!=="svelte-8b9s3u"&&(gt.innerHTML=_a),Kl=f(e),wt=u(e,"P",{"data-svelte-h":!0}),_(wt)!=="svelte-12oqu2m"&&(wt.textContent=xa),$l=f(e),Re=u(e,"H3",{id:!0,"data-svelte-h":!0}),_(Re)!=="svelte-wn82h4"&&(Re.textContent=ga),Ql=f(e),At=u(e,"P",{"data-svelte-h":!0}),_(At)!=="svelte-1r1k23z"&&(At.textContent=wa),Zl=f(e),Dt=u(e,"P",{"data-svelte-h":!0}),_(Dt)!=="svelte-xr3tbp"&&(Dt.textContent=Aa),es=f(e),kt=u(e,"P",{"data-svelte-h":!0}),_(kt)!=="svelte-1eoavzo"&&(kt.textContent=Da),ts=f(e),Et=u(e,"P",{"data-svelte-h":!0}),_(Et)!=="svelte-1mowci7"&&(Et.textContent=ka),ls=f(e),Tt=u(e,"P",{"data-svelte-h":!0}),_(Tt)!=="svelte-1baxlyb"&&(Tt.textContent=Ea),ss=f(e),Lt=u(e,"P",{"data-svelte-h":!0}),_(Lt)!=="svelte-iskkee"&&(Lt.textContent=Ta),ns=f(e),Pt=u(e,"P",{"data-svelte-h":!0}),_(Pt)!=="svelte-cd2ftd"&&(Pt.textContent=La),as=f(e),Bt=u(e,"P",{"data-svelte-h":!0}),_(Bt)!=="svelte-xf56yd"&&(Bt.textContent=Pa),os=f(e),Oe=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(Oe)!=="svelte-eaor50"&&(Oe.textContent=Ba),is=f(e),It=u(e,"P",{"data-svelte-h":!0}),_(It)!=="svelte-1smcvtv"&&(It.textContent=Ia),rs=f(e),Mt=u(e,"P",{"data-svelte-h":!0}),_(Mt)!=="svelte-wx1mvn"&&(Mt.textContent=Ma),cs=f(e),St=u(e,"OL",{"data-svelte-h":!0}),_(St)!=="svelte-1ojh4y6"&&(St.innerHTML=Sa),ps=f(e),zt=u(e,"P",{"data-svelte-h":!0}),_(zt)!=="svelte-njadbf"&&(zt.textContent=za),us=f(e),Ft=u(e,"P",{"data-svelte-h":!0}),_(Ft)!=="svelte-eoc7ou"&&(Ft.textContent=Fa),hs=f(e),Tl=ra(e,!1),Ll=f(e),Vt=u(e,"P",{"data-svelte-h":!0}),_(Vt)!=="svelte-1ciyndb"&&(Vt.textContent=Va),fs=f(e),Pl=ra(e,!1),Bl=f(e),Ht=u(e,"P",{"data-svelte-h":!0}),_(Ht)!=="svelte-5417so"&&(Ht.textContent=Ha),ds=f(e),Ue=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(Ue)!=="svelte-1mq7nxo"&&(Ue.textContent=Na),ms=f(e),Nt=u(e,"P",{"data-svelte-h":!0}),_(Nt)!=="svelte-ejxmx7"&&(Nt.textContent=Ra),ys=f(e),Rt=u(e,"P",{"data-svelte-h":!0}),_(Rt)!=="svelte-q6nbic"&&(Rt.textContent=Oa),Cs=f(e),We=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(We)!=="svelte-rqsxow"&&(We.textContent=Ua),vs=f(e),Ot=u(e,"P",{"data-svelte-h":!0}),_(Ot)!=="svelte-eavk78"&&(Ot.textContent=Wa),bs=f(e),Ut=u(e,"P",{"data-svelte-h":!0}),_(Ut)!=="svelte-5rw3rn"&&(Ut.textContent=qa),_s=f(e),qe=u(e,"IMG",{src:!0,alt:!0,style:!0}),xs=f(e),je=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(je)!=="svelte-1ivpyoa"&&(je.textContent=Ga),gs=f(e),Wt=u(e,"P",{"data-svelte-h":!0}),_(Wt)!=="svelte-1slhxew"&&(Wt.textContent=Ya),ws=f(e),qt=u(e,"P",{"data-svelte-h":!0}),_(qt)!=="svelte-qe6vyt"&&(qt.textContent=Xa),As=f(e),Ge=u(e,"IMG",{src:!0,alt:!0,style:!0}),Ds=f(e),jt=u(e,"P",{"data-svelte-h":!0}),_(jt)!=="svelte-pcb7i3"&&(jt.textContent=Ka),ks=f(e),Ye=u(e,"IMG",{src:!0,alt:!0,style:!0}),Es=f(e),Xe=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(Xe)!=="svelte-12gyf8n"&&(Xe.textContent=Qa),Ts=f(e),Gt=u(e,"P",{"data-svelte-h":!0}),_(Gt)!=="svelte-1uq08ym"&&(Gt.textContent=Za),Ls=f(e),Je=u(e,"IMG",{src:!0,alt:!0,style:!0}),Ps=f(e),Ke=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(Ke)!=="svelte-1fze339"&&(Ke.textContent=to),Bs=f(e),Yt=u(e,"P",{"data-svelte-h":!0}),_(Yt)!=="svelte-c43jgt"&&(Yt.textContent=lo),Is=f(e),$e=u(e,"IMG",{src:!0,alt:!0,style:!0}),Ms=f(e),Qe=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(Qe)!=="svelte-hv8k2d"&&(Qe.textContent=no),Ss=f(e),Xt=u(e,"P",{"data-svelte-h":!0}),_(Xt)!=="svelte-clk2zw"&&(Xt.textContent=ao),zs=f(e),Jt=u(e,"P",{"data-svelte-h":!0}),_(Jt)!=="svelte-1v7ljf6"&&(Jt.textContent=oo),Fs=f(e),Ze=u(e,"IMG",{src:!0,alt:!0,style:!0}),Vs=f(e),et=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(et)!=="svelte-r4hn4r"&&(et.textContent=ro),Hs=f(e),Kt=u(e,"P",{"data-svelte-h":!0}),_(Kt)!=="svelte-168213b"&&(Kt.textContent=co),Ns=f(e),$t=u(e,"P",{"data-svelte-h":!0}),_($t)!=="svelte-1ky94c8"&&($t.textContent=po),Rs=f(e),Qt=u(e,"P",{"data-svelte-h":!0}),_(Qt)!=="svelte-1cerr1s"&&(Qt.textContent=uo),Os=f(e),tt=u(e,"IMG",{src:!0,alt:!0,style:!0}),Us=f(e),lt=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(lt)!=="svelte-1dsa12"&&(lt.textContent=fo),Ws=f(e),Zt=u(e,"P",{"data-svelte-h":!0}),_(Zt)!=="svelte-fq06em"&&(Zt.textContent=mo),qs=f(e),el=u(e,"P",{"data-svelte-h":!0}),_(el)!=="svelte-vf4rvr"&&(el.textContent=yo),js=f(e),tl=u(e,"P",{"data-svelte-h":!0}),_(tl)!=="svelte-1die5vv"&&(tl.textContent=Co),Gs=f(e),st=u(e,"IMG",{src:!0,alt:!0,style:!0}),Ys=f(e),ll=u(e,"P",{"data-svelte-h":!0}),_(ll)!=="svelte-1j81ob0"&&(ll.textContent=bo),Xs=f(e),nt=u(e,"IMG",{src:!0,alt:!0,style:!0}),Js=f(e),at=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(at)!=="svelte-1gmrokg"&&(at.textContent=xo),Ks=f(e),sl=u(e,"P",{"data-svelte-h":!0}),_(sl)!=="svelte-1f6zl1a"&&(sl.textContent=go),$s=f(e),nl=u(e,"P",{"data-svelte-h":!0}),_(nl)!=="svelte-19k3t64"&&(nl.textContent=wo),Qs=f(e),al=u(e,"P",{"data-svelte-h":!0}),_(al)!=="svelte-hs2zj9"&&(al.textContent=Ao),Zs=f(e),ot=u(e,"IMG",{src:!0,alt:!0,style:!0}),en=f(e),it=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(it)!=="svelte-1izk9uu"&&(it.textContent=ko),tn=f(e),ol=u(e,"P",{"data-svelte-h":!0}),_(ol)!=="svelte-1sgedn5"&&(ol.textContent=Eo),ln=f(e),il=u(e,"P",{"data-svelte-h":!0}),_(il)!=="svelte-wnw36k"&&(il.textContent=To),sn=f(e),rt=u(e,"IMG",{src:!0,alt:!0,style:!0}),nn=f(e),ct=u(e,"H1",{id:!0,"data-svelte-h":!0}),_(ct)!=="svelte-5xxd9f"&&(ct.textContent=Po),an=f(e),rl=u(e,"P",{"data-svelte-h":!0}),_(rl)!=="svelte-1tuudv0"&&(rl.textContent=Bo),on=f(e),cl=u(e,"P",{"data-svelte-h":!0}),_(cl)!=="svelte-aa5a50"&&(cl.textContent=Io),rn=f(e),pl=u(e,"P",{"data-svelte-h":!0}),_(pl)!=="svelte-1jckajt"&&(pl.textContent=Mo),cn=f(e),Il=ra(e,!1),Ml=f(e),ul=u(e,"P",{"data-svelte-h":!0}),_(ul)!=="svelte-198ivlo"&&(ul.textContent=So),pn=f(e),Le=u(e,"DIV",{class:!0});var n=k(Le);we=u(n,"DIV",{class:!0});var B=k(we);hl=u(B,"DIV",{class:!0,"data-svelte-h":!0}),_(hl)!=="svelte-1xohaki"&&(hl.innerHTML=zo),Ln=f(B),J=u(B,"DIV",{style:!0});var D=k(J);se=u(D,"DIV",{style:!0}),k(se).forEach(l),Pn=f(D),te=u(D,"DIV",{style:!0}),k(te).forEach(l),Bn=f(D),W=u(D,"INPUT",{type:!0,min:!0,max:!0,style:!0}),D.forEach(l),In=f(B),R=u(B,"DIV",{style:!0});var H=k(R);Pe=u(H,"BUTTON",{class:!0});var Uo=k(Pe);Mn=z(Uo,"‹‹‹"),Uo.forEach(l),Sn=f(H),Be=u(H,"BUTTON",{class:!0});var Wo=k(Be);zn=z(Wo,"‹‹"),Wo.forEach(l),Fn=f(H),Ie=u(H,"BUTTON",{class:!0});var qo=k(Ie);Vn=z(qo,"‹"),qo.forEach(l),Hn=f(H),Ae=u(H,"DIV",{style:!0});var na=k(Ae);Al=u(na,"SPAN",{class:!0});var jo=k(Al);dn=z(jo,i[1]),jo.forEach(l),fl=u(na,"SPAN",{class:!0});var aa=k(fl);Nn=z(aa,"/ "),mn=z(aa,i[0]),aa.forEach(l),na.forEach(l),Rn=f(H),Me=u(H,"BUTTON",{class:!0});var Go=k(Me);On=z(Go,"›"),Go.forEach(l),Un=f(H),Se=u(H,"BUTTON",{class:!0});var Yo=k(Se);Wn=z(Yo,"››"),Yo.forEach(l),qn=f(H),ze=u(H,"BUTTON",{class:!0});var Xo=k(ze);jn=z(Xo,"›››"),Xo.forEach(l),H.forEach(l),B.forEach(l),Gn=f(n),pt=u(n,"DIV",{class:!0});var gn=k(pt);pe=u(gn,"DIV",{class:!0});var mt=k(pe);dl=u(mt,"H3",{class:!0,"data-svelte-h":!0}),_(dl)!=="svelte-1d49xy"&&(dl.textContent=Fo),Yn=f(mt),ml=u(mt,"DIV",{class:!0,style:!0});var Jo=k(ml);ue=Vl(Jo,"svg",{viewBox:!0,width:!0,style:!0,preserveAspectRatio:!0});var oa=k(ue);for(let ee=0;ee<5;ee+=1)Dl[ee].l(oa);Xn=O();for(let ee=0;ee<G.length;ee+=1)G[ee].l(oa);oa.forEach(l),Jo.forEach(l),Jn=f(mt),yl=u(mt,"H3",{class:!0,"data-svelte-h":!0}),_(yl)!=="svelte-bt5ft4"&&(yl.textContent=Vo),Kn=f(mt),De=u(mt,"DIV",{class:!0});var wn=k(De);Z&&Z.l(wn),bn=f(wn);for(let ee=0;ee<4;ee+=1)de[ee].l(wn);wn.forEach(l),mt.forEach(l),$n=f(gn),ut=u(gn,"DIV",{class:!0});var An=k(ut);ht=u(An,"DIV",{class:!0});var Dn=k(ht);ft=u(Dn,"H3",{class:!0});var kn=k(ft);Qn=z(kn,"Live Registers ("),_n=z(kn,Sl),Zn=z(kn,")"),kn.forEach(l),ea=f(Dn),be=u(Dn,"DIV",{style:!0});var Ko=k(be);for(let ee=0;ee<Y.length;ee+=1)Y[ee].l(Ko);Ko.forEach(l),Dn.forEach(l),ta=f(An),Cl=u(An,"DIV",{class:!0});var $o=k(Cl);fe.l($o),$o.forEach(l),An.forEach(l),gn.forEach(l),n.forEach(l),xn=f(e),vl=u(e,"STYLE",{"data-svelte-h":!0}),_(vl)!=="svelte-7vufmq"&&(vl.textContent=Ho),this.h()},h(){d(r,"id","contents"),d(x,"id","problem-statement"),d(T,"id","the-processor"),d(xe,"id","the-algorithm"),d(U,"id","compute-and-memory-bounds"),d(N,"id","ops"),d(He,"id","aside-main-memory-indexing"),d(Ne,"id","memory"),d(Re,"id","muxing"),d(Oe,"id","symbolic-intermediate-representation"),Tl.a=Ll,Pl.a=Bl,d(Ue,"id","compiling"),d(We,"id","first-shot-2107-cycles"),_e(qe.src,ja=me+"/anthropic/"+i[8][0])||d(qe,"src",ja),d(qe,"alt","First shot trace"),b(qe,"margin","1em 0em"),d(je,"id","mux-level-0-1860-cycles"),_e(Ge.src,Ja=me+"/anthropic/"+i[8][1])||d(Ge,"src",Ja),d(Ge,"alt","Mux 0 zoomed"),b(Ge,"margin","1em 0em"),_e(Ye.src,$a=me+"/anthropic/"+i[8][2])||d(Ye,"src",$a),d(Ye,"alt","Mux 0 full trace"),b(Ye,"margin","1em 0em"),d(Xe,"id","mux-level-1-1722-cycles"),_e(Je.src,eo=me+"/anthropic/"+i[8][3])||d(Je,"src",eo),d(Je,"alt","Mux 1 trace"),b(Je,"margin","1em 0em"),d(Ke,"id","mux-level-2-1655-cycles"),_e($e.src,so=me+"/anthropic/"+i[8][4])||d($e,"src",so),d($e,"alt","Mux 2 load bubbles"),b($e,"margin","1em 0em"),d(Qe,"id","mux-level-3-1620-cycles-but-out-of-registers"),_e(Ze.src,io=me+"/anthropic/"+i[8][5])||d(Ze,"src",io),d(Ze,"alt","Mux 3 register outage"),b(Ze,"margin","1em 0em"),d(et,"id","mux-level-3-rotated-input-1548-cycles"),_e(tt.src,ho=me+"/anthropic/"+i[8][6])||d(tt,"src",ho),d(tt,"alt","Mux 3 input rotation"),b(tt,"margin","1em 0em"),d(lt,"id","optimize-preamble-1498-cycles"),_e(st.src,vo=me+"/anthropic/"+i[8][7])||d(st,"src",vo),d(st,"alt","Preamble before"),b(st,"margin","1em 0em"),_e(nt.src,_o=me+"/anthropic/"+i[8][8])||d(nt,"src",_o),d(nt,"alt","Preamble after"),b(nt,"margin","1em 0em"),d(at,"id","use-the-rest-of-the-alu-1240-cycles"),_e(ot.src,Do=me+"/anthropic/"+i[8][9])||d(ot,"src",Do),d(ot,"alt","ALU expanded"),b(ot,"margin","1em 0em"),d(it,"id","optimize-tail-1218-cycles"),_e(rt.src,Lo=me+"/anthropic/"+i[8][10])||d(rt,"src",Lo),d(rt,"alt","Tail optimized"),b(rt,"margin","1em 0em"),d(ct,"id","final-thoughts"),Il.a=Ml,d(hl,"class","flex justify-between items-center mb-3"),b(se,"position","absolute"),b(se,"top","0"),b(se,"left","0"),b(se,"height","100%"),b(se,"border-radius","9999px"),b(se,"transition","width 75ms"),b(se,"width",i[6]+"%"),b(se,"background","#2563eb"),b(te,"position","absolute"),b(te,"top","50%"),b(te,"transform","translateY(-50%)"),b(te,"width","1rem"),b(te,"height","1rem"),b(te,"border-radius","9999px"),b(te,"background","white"),b(te,"left","calc("+i[6]+"% - 8px)"),b(te,"box-shadow","0 0 10px rgba(37,99,235,0.8)"),d(W,"type","range"),d(W,"min","0"),d(W,"max",i[0]),W.value=i[1],b(W,"position","absolute"),b(W,"top","0"),b(W,"left","0"),b(W,"width","100%"),b(W,"height","100%"),b(W,"opacity","0"),b(W,"cursor","pointer"),b(W,"margin","0"),b(J,"position","relative"),b(J,"width","100%"),b(J,"height","1.25rem"),b(J,"border-radius","9999px"),b(J,"margin-bottom","0.75rem"),b(J,"cursor","pointer"),b(J,"background","#1e293b"),d(Pe,"class","btn"),Pe.disabled=un=i[1]<=0,d(Be,"class","btn"),Be.disabled=hn=i[1]<=0,d(Ie,"class","btn"),Ie.disabled=fn=i[1]<=0,d(Al,"class","text-white font-bold text-sm"),d(fl,"class","text-gray-500 text-sm ml-1"),b(Ae,"display","flex"),b(Ae,"align-items","center"),b(Ae,"justify-content","center"),b(Ae,"text-align","center"),d(Me,"class","btn"),Me.disabled=yn=i[1]>=i[0],d(Se,"class","btn"),Se.disabled=Cn=i[1]>=i[0],d(ze,"class","btn"),ze.disabled=vn=i[1]>=i[0],b(R,"display","grid"),b(R,"grid-template-columns","repeat(7, 1fr)"),b(R,"gap","4px"),b(R,"align-items","stretch"),d(we,"class","header mb-4 border-b border-gray-800 pb-4"),d(dl,"class","text-xs font-bold text-gray-500 uppercase tracking-wider mb-2"),d(ue,"viewBox","0 0 200 100"),d(ue,"width","100%"),b(ue,"display","block"),d(ue,"preserveAspectRatio","xMinYMin meet"),d(ml,"class","bg-gray-900/50 rounded-lg p-2 mb-3 border border-gray-800"),b(ml,"flex-shrink","0"),d(yl,"class","text-xs font-bold text-gray-500 uppercase tracking-wider mb-2"),d(De,"class","overflow-y-auto pr-2 custom-scrollbar flex-1"),d(pe,"class","col-span-4 flex flex-col min-h-0 border-r border-gray-800 pr-4"),d(ft,"class","text-xs font-bold text-gray-500 uppercase tracking-wider"),b(be,"display","flex"),b(be,"flex-wrap","wrap"),b(be,"gap","6px"),b(be,"font-size","10px"),b(be,"margin-bottom","6px"),d(ht,"class","flex justify-between items-end mb-20px"),d(Cl,"class","bg-gray-900/50 rounded-lg p-4 flex-1 overflow-y-auto custom-scrollbar border border-gray-800 shadow-inner"),d(ut,"class","col-span-8 flex flex-col min-h-0"),d(pt,"class","flex-1 grid grid-cols-12 gap-6 min-h-0"),d(Le,"class","trace-viewer font-mono bg-gray-950 text-gray-200 p-4 rounded-lg border border-gray-800 shadow-2xl h-[800px] flex flex-col")},m(e,n){a(e,t,n),a(e,o,n),a(e,r,n),a(e,m,n),a(e,y,n),a(e,g,n),a(e,x,n),a(e,A,n),a(e,T,n),a(e,Ce,n),a(e,X,n),a(e,oe,n),a(e,ie,n),a(e,_l,n),a(e,ke,n),a(e,Fe,n),a(e,xe,n),a(e,xl,n),a(e,ge,n),a(e,gl,n),a(e,Ee,n),a(e,wl,n),a(e,Te,n),a(e,L,n),a(e,P,n),a(e,E,n),a(e,U,n),a(e,M,n),a(e,N,n),a(e,Ve,n),a(e,le,n),a(e,$,n),a(e,Q,n),a(e,Ul,n),a(e,Ct,n),a(e,Wl,n),a(e,vt,n),a(e,ql,n),a(e,He,n),a(e,jl,n),a(e,bt,n),a(e,Gl,n),a(e,_t,n),a(e,Yl,n),a(e,Ne,n),a(e,Xl,n),a(e,xt,n),a(e,Jl,n),a(e,gt,n),a(e,Kl,n),a(e,wt,n),a(e,$l,n),a(e,Re,n),a(e,Ql,n),a(e,At,n),a(e,Zl,n),a(e,Dt,n),a(e,es,n),a(e,kt,n),a(e,ts,n),a(e,Et,n),a(e,ls,n),a(e,Tt,n),a(e,ss,n),a(e,Lt,n),a(e,ns,n),a(e,Pt,n),a(e,as,n),a(e,Bt,n),a(e,os,n),a(e,Oe,n),a(e,is,n),a(e,It,n),a(e,rs,n),a(e,Mt,n),a(e,cs,n),a(e,St,n),a(e,ps,n),a(e,zt,n),a(e,us,n),a(e,Ft,n),a(e,hs,n),Tl.m(Li,e,n),a(e,Ll,n),a(e,Vt,n),a(e,fs,n),Pl.m(Pi,e,n),a(e,Bl,n),a(e,Ht,n),a(e,ds,n),a(e,Ue,n),a(e,ms,n),a(e,Nt,n),a(e,ys,n),a(e,Rt,n),a(e,Cs,n),a(e,We,n),a(e,vs,n),a(e,Ot,n),a(e,bs,n),a(e,Ut,n),a(e,_s,n),a(e,qe,n),a(e,xs,n),a(e,je,n),a(e,gs,n),a(e,Wt,n),a(e,ws,n),a(e,qt,n),a(e,As,n),a(e,Ge,n),a(e,Ds,n),a(e,jt,n),a(e,ks,n),a(e,Ye,n),a(e,Es,n),a(e,Xe,n),a(e,Ts,n),a(e,Gt,n),a(e,Ls,n),a(e,Je,n),a(e,Ps,n),a(e,Ke,n),a(e,Bs,n),a(e,Yt,n),a(e,Is,n),a(e,$e,n),a(e,Ms,n),a(e,Qe,n),a(e,Ss,n),a(e,Xt,n),a(e,zs,n),a(e,Jt,n),a(e,Fs,n),a(e,Ze,n),a(e,Vs,n),a(e,et,n),a(e,Hs,n),a(e,Kt,n),a(e,Ns,n),a(e,$t,n),a(e,Rs,n),a(e,Qt,n),a(e,Os,n),a(e,tt,n),a(e,Us,n),a(e,lt,n),a(e,Ws,n),a(e,Zt,n),a(e,qs,n),a(e,el,n),a(e,js,n),a(e,tl,n),a(e,Gs,n),a(e,st,n),a(e,Ys,n),a(e,ll,n),a(e,Xs,n),a(e,nt,n),a(e,Js,n),a(e,at,n),a(e,Ks,n),a(e,sl,n),a(e,$s,n),a(e,nl,n),a(e,Qs,n),a(e,al,n),a(e,Zs,n),a(e,ot,n),a(e,en,n),a(e,it,n),a(e,tn,n),a(e,ol,n),a(e,ln,n),a(e,il,n),a(e,sn,n),a(e,rt,n),a(e,nn,n),a(e,ct,n),a(e,an,n),a(e,rl,n),a(e,on,n),a(e,cl,n),a(e,rn,n),a(e,pl,n),a(e,cn,n),Il.m(Bi,e,n),a(e,Ml,n),a(e,ul,n),a(e,pn,n),a(e,Le,n),w(Le,we),w(we,hl),w(we,Ln),w(we,J),w(J,se),w(J,Pn),w(J,te),w(J,Bn),w(J,W),w(we,In),w(we,R),w(R,Pe),w(Pe,Mn),w(R,Sn),w(R,Be),w(Be,zn),w(R,Fn),w(R,Ie),w(Ie,Vn),w(R,Hn),w(R,Ae),w(Ae,Al),w(Al,dn),w(Ae,fl),w(fl,Nn),w(fl,mn),w(R,Rn),w(R,Me),w(Me,On),w(R,Un),w(R,Se),w(Se,Wn),w(R,qn),w(R,ze),w(ze,jn),w(Le,Gn),w(Le,pt),w(pt,pe),w(pe,dl),w(pe,Yn),w(pe,ml),w(ml,ue);for(let B=0;B<5;B+=1)Dl[B]&&Dl[B].m(ue,null);w(ue,Xn);for(let B=0;B<G.length;B+=1)G[B]&&G[B].m(ue,null);w(pe,Jn),w(pe,yl),w(pe,Kn),w(pe,De),Z&&Z.m(De,null),w(De,bn);for(let B=0;B<4;B+=1)de[B]&&de[B].m(De,null);w(pt,$n),w(pt,ut),w(ut,ht),w(ht,ft),w(ft,Qn),w(ft,_n),w(ft,Zn),w(ht,ea),w(ht,be);for(let B=0;B<Y.length;B+=1)Y[B]&&Y[B].m(be,null);w(ut,ta),w(ut,Cl),dt[he].m(Cl,null),a(e,xn,n),a(e,vl,n),j=!0,la||(No=[bl(W,"input",i[14]),bl(Pe,"click",i[18]),bl(Be,"click",i[19]),bl(Ie,"click",i[20]),bl(Me,"click",i[21]),bl(Se,"click",i[22]),bl(ze,"click",i[23])],la=!0)},p(e,n){if((!j||n[0]&64)&&b(se,"width",e[6]+"%"),(!j||n[0]&64)&&b(te,"left","calc("+e[6]+"% - 8px)"),(!j||n[0]&1)&&d(W,"max",e[0]),(!j||n[0]&2)&&(W.value=e[1]),(!j||n[0]&2&&un!==(un=e[1]<=0))&&(Pe.disabled=un),(!j||n[0]&2&&hn!==(hn=e[1]<=0))&&(Be.disabled=hn),(!j||n[0]&2&&fn!==(fn=e[1]<=0))&&(Ie.disabled=fn),(!j||n[0]&2)&&ye(dn,e[1]),(!j||n[0]&1)&&ye(mn,e[0]),(!j||n[0]&3&&yn!==(yn=e[1]>=e[0]))&&(Me.disabled=yn),(!j||n[0]&3&&Cn!==(Cn=e[1]>=e[0]))&&(Se.disabled=Cn),(!j||n[0]&3&&vn!==(vn=e[1]>=e[0]))&&(ze.disabled=vn),n[0]&48){kl=ne(e[4]);let D;for(D=0;D<kl.length;D+=1){const H=ai(e,kl,D);G[D]?G[D].p(H,n):(G[D]=oi(H),G[D].c(),G[D].m(ue,null))}for(;D<G.length;D+=1)G[D].d(1);G.length=kl.length}if(e[7].aluValu.length===0&&e[7].load.length===0&&e[7].store.length===0&&e[7].vselect.length===0?Z||(Z=ii(),Z.c(),Z.m(De,bn)):Z&&(Z.d(1),Z=null),n[0]&7296){sa=ne([{key:"aluValu",label:"ALU / VALU"},{key:"load",label:"LOAD"},{key:"store",label:"STORE"},{key:"vselect",label:"VSELECT"}]);let D;for(D=0;D<4;D+=1){const H=li(e,sa,D);de[D]?de[D].p(H,n):(de[D]=Ci(H),de[D].c(),de[D].m(De,null))}for(;D<4;D+=1)de[D].d(1)}if((!j||n[0]&8)&&Sl!==(Sl=e[3].length+"")&&ye(_n,Sl),n[0]&1536){El=ne(Object.entries(e[9]));let D;for(D=0;D<El.length;D+=1){const H=ti(e,El,D);Y[D]?Y[D].p(H,n):(Y[D]=vi(H),Y[D].c(),Y[D].m(be,null))}for(;D<Y.length;D+=1)Y[D].d(1);Y.length=El.length}let B=he;he=Oo(e),he===B?dt[he].p(e,n):(gi(),Tn(dt[B],1,1,()=>{dt[B]=null}),wi(),fe=dt[he],fe?fe.p(e,n):(fe=dt[he]=Ro[he](e),fe.c()),En(fe,1),fe.m(Cl,null))},i(e){j||(En(fe),j=!0)},o(e){Tn(fe),j=!1},d(e){e&&(l(t),l(o),l(r),l(m),l(y),l(g),l(x),l(A),l(T),l(Ce),l(X),l(oe),l(ie),l(_l),l(ke),l(Fe),l(xe),l(xl),l(ge),l(gl),l(Ee),l(wl),l(Te),l(L),l(P),l(E),l(U),l(M),l(N),l(Ve),l(le),l($),l(Q),l(Ul),l(Ct),l(Wl),l(vt),l(ql),l(He),l(jl),l(bt),l(Gl),l(_t),l(Yl),l(Ne),l(Xl),l(xt),l(Jl),l(gt),l(Kl),l(wt),l($l),l(Re),l(Ql),l(At),l(Zl),l(Dt),l(es),l(kt),l(ts),l(Et),l(ls),l(Tt),l(ss),l(Lt),l(ns),l(Pt),l(as),l(Bt),l(os),l(Oe),l(is),l(It),l(rs),l(Mt),l(cs),l(St),l(ps),l(zt),l(us),l(Ft),l(hs),Tl.d(),l(Ll),l(Vt),l(fs),Pl.d(),l(Bl),l(Ht),l(ds),l(Ue),l(ms),l(Nt),l(ys),l(Rt),l(Cs),l(We),l(vs),l(Ot),l(bs),l(Ut),l(_s),l(qe),l(xs),l(je),l(gs),l(Wt),l(ws),l(qt),l(As),l(Ge),l(Ds),l(jt),l(ks),l(Ye),l(Es),l(Xe),l(Ts),l(Gt),l(Ls),l(Je),l(Ps),l(Ke),l(Bs),l(Yt),l(Is),l($e),l(Ms),l(Qe),l(Ss),l(Xt),l(zs),l(Jt),l(Fs),l(Ze),l(Vs),l(et),l(Hs),l(Kt),l(Ns),l($t),l(Rs),l(Qt),l(Os),l(tt),l(Us),l(lt),l(Ws),l(Zt),l(qs),l(el),l(js),l(tl),l(Gs),l(st),l(Ys),l(ll),l(Xs),l(nt),l(Js),l(at),l(Ks),l(sl),l($s),l(nl),l(Qs),l(al),l(Zs),l(ot),l(en),l(it),l(tn),l(ol),l(ln),l(il),l(sn),l(rt),l(nn),l(ct),l(an),l(rl),l(on),l(cl),l(rn),l(pl),l(cn),Il.d(),l(Ml),l(ul),l(pn),l(Le),l(xn),l(vl)),zl(Dl,e),zl(G,e),Z&&Z.d(),zl(de,e),zl(Y,e),dt[he].d(),la=!1,Vi(No)}}}function dr(i){let t,s;const o=[i[15],ua];let r={$$slots:{default:[fr]},$$scope:{ctx:i}};for(let c=0;c<o.length;c+=1)r=pa(r,o[c]);return t=new $i({props:r}),{c(){qi(t.$$.fragment)},l(c){ji(t.$$.fragment,c)},m(c,m){Gi(t,c,m),s=!0},p(c,m){const y=m[0]&32768?Qi(o,[m[0]&32768&&Zo(c[15]),m&0&&Zo(ua)]):{};m[0]&255|m[1]&268435456&&(y.$$scope={dirty:m,ctx:c}),t.$set(y)},i(c){s||(En(t.$$.fragment,c),s=!0)},o(c){Tn(t.$$.fragment,c),s=!1},d(c){Yi(t,c)}}}const ua={title:"I tried Anthropic's Performance Takehome",date:"2026-02-09",published:!0},_i=/\b([a-z0-9_]+)\(([^)]+)\)/g;function ha(i,t){return i.replace(/batch=(\d+)/g,(s,o)=>`b${Math.floor(parseInt(o)/8)}`).replace("round=","r").replace("stage=","s").replace("slots=","sz").replace("level=","L").replace("node=","n").replace("part=","p").replace("idx=","i").replace(/\s/g,"")}function mr(i){const t=i.match(/^([a-z0-9_]+)\(/);if(!t)return"default";const s=t[1].split("_")[0];return["val","idx","tree","const","mux","hash","mod","mem"].includes(s)||t[1].startsWith("hash")||t[1].startsWith("mod")?s:"default"}function yr(i){if(!i||i.length===0)return{aluValu:[],load:[],store:[],vselect:[]};const t={aluValu:[],load:[],store:[],vselect:[]},s=new Set;for(const o of i){const r=o.tid??-1,c=o.name;if(c.includes("vselect"))t.vselect.push(o);else if(r>=19&&r<=20)t.load.push(o);else if(r>=21&&r<=22)t.store.push(o);else{if(r>=1&&r<=12){if(s.has(c))continue;s.add(c)}t.aluValu.push(o)}}return t}function Cr(i,t,s){let o,r,c,m,y=["01_first-shot-trace.png","02_mux0-zoomed.png","03_mux0-full-trace.png","04_mux1-trace.png","05_mux2-load-bubbles.png","06_mux3-register-outage.png","07_mux3-input-rotation.png","08_preamble-before.png","09_preamble-after.png","10_alu-expanded.png","11_tail-optimized.png"],v=[],g=0,x=1,C=!0,A=[],T=new Map,F=[],Ce=new Map,X=[];const ve={bg:"#92400e",text:"#fcd34d",border:"#d97706"},oe={val:{bg:"#1e3a8a",text:"#bfdbfe",border:"#1d4ed8"},idx:{bg:"#064e3b",text:"#a7f3d0",border:"#047857"},tree:{bg:"#78350f",text:"#fde68a",border:"#b45309"},const:ve,mux:{bg:"#831843",text:"#fbcfe8",border:"#be185d"},hash:{bg:"#2e1065",text:"#ddd6fe",border:"#5b21b6"},mod:{bg:"#312e81",text:"#c7d2fe",border:"#4338ca"},mem:{bg:"#1f2937",text:"#d1d5db",border:"#4b5563"},default:{bg:"#111827",text:"#e5e7eb",border:"#374151"}};function ie(I){const L=oe[I]||oe.default;return`background-color: ${L.bg}; color: ${L.text}; border: 1px solid ${L.border};`}function Hl(){return`color: ${ve.text};`}Fi(async()=>{try{const P=(await(await fetch(`${me}/anthropic/trace.json`)).text()).replace(/,\s*\]$/,"]");v=JSON.parse(P),_l(v),s(2,C=!1),window.addEventListener("keydown",ge)}catch(I){console.error("Failed to load or parse trace.json",I),s(2,C=!1)}return()=>{window.removeEventListener("keydown",ge)}});function _l(I){const L=new Map,P=[];let q=0;const E=new Map,U=/\b([a-z0-9_]+)\(([^)]+)\)/g;I.forEach(V=>{if(V.ph!=="X"||!V.args||!V.args.named)return;const M=V.ts;M>q&&(q=M),P[M]||(P[M]=[]),P[M].push({name:V.name,raw:V.args.named,cat:V.cat,tid:V.tid??-1});const N=V.name;U.lastIndex=0;let ce;for(;(ce=U.exec(N))!==null;){const K=ce[0],$=ce[1].split("_")[0];let Q="default";if((["val","idx","tree","const","mux","hash","mod","mem"].includes($)||ce[1].startsWith("hash")||ce[1].startsWith("mod"))&&(Q=$),!L.has(K))L.set(K,{id:K,type:Q,start:M,end:M,shortName:ha(K)});else{const yt=L.get(K);M>yt.end&&(yt.end=M),M<yt.start&&(yt.start=M)}}const Ve=/val\(batch=(\d+),round=(\d+),stage=0\)/g;let le;for(;(le=Ve.exec(N))!==null;){const K=Math.floor(parseInt(le[1])/8),$=parseInt(le[2]);E.has(K)||E.set(K,[]),E.get(K).push({cycle:M,round:$})}if(N.includes("vstore")){const K=/val\(batch=(\d+)/g;let $;for(;($=K.exec(N))!==null;){const Q=Math.floor(parseInt($[1])/8);E.has(Q)||E.set(Q,[]),E.get(Q).push({cycle:M,round:16})}}});for(const[,V]of E.entries())V.sort((M,N)=>M.cycle-N.cycle);Ce=E,s(4,X=[...E.keys()].sort((V,M)=>V-M)),s(16,A=P),s(0,g=q),T=L,Fe()}function ke(I){const L=[];_i.lastIndex=0;let P;for(;(P=_i.exec(I))!==null;)L.push(P[0]);return L}function Nl(I){const L=I.match(/^B(\d+):\s*(.*)$/),P=L?`B${Math.floor(parseInt(L[1])/8)}`:null,q=L?L[2]:I,E=ke(q);if(q==="pause"||q==="init")return{batchPrefix:P,op:q,lines:[{textOnly:q}]};if(q.includes("←")){const[M,N]=q.split("←").map(ce=>ce.trim());if(/^\d+$/.test(N))return{batchPrefix:P,op:"const",lines:[{reg:E[0],symbol:"←"},{literal:N}]};if(M.startsWith("vstore "))return{batchPrefix:P,op:"vstore",lines:[{prefix:"mem[",reg:E[0],suffix:"]",symbol:"←"},{reg:E[1]}]};if(N.startsWith("mem[")){const ce=N.indexOf("]"),Ve=N.slice(4,ce),le=E[1],$=Ve.slice(le.length)+"]";return{batchPrefix:P,op:M.split(/\s+/)[0],lines:[{reg:E[0],symbol:"←"},{prefix:"mem[",reg:E[1],suffix:$}]}}return{batchPrefix:P,op:M.split(/\s+/)[0],lines:[{reg:E[0],symbol:"←"},{reg:E[1]}]}}const U=q.match(/^(\S+)\s+/),V=U?U[1]:"";return V==="vmultiply_add"?{batchPrefix:P,op:V,lines:[{reg:E[0],symbol:"="},{reg:E[1],symbol:"*"},{reg:E[2],symbol:"+"},{reg:E[3]}]}:V==="vselect"?{batchPrefix:P,op:V,lines:[{reg:E[0],symbol:"="},{reg:E[1],symbol:"?"},{reg:E[2],symbol:":"},{reg:E[3]}]}:{batchPrefix:P,op:V,lines:[{reg:E[0],symbol:"="},{reg:E[1]},{symbol:V},{reg:E[2]}]}}function Fe(){if(!T.size)return;const I=[];for(const L of T.values())L.start<=x&&L.end>=x&&I.push(L);I.sort((L,P)=>L.type!==P.type?L.type.localeCompare(P.type):L.id.localeCompare(P.id)),s(3,F=I)}function xe(I){const L=new Map;for(const P of X)L.set(P,0);for(const[P,q]of Ce.entries()){let E=0;for(const U of q)if(U.cycle<=I)U.round>E&&(E=U.round);else break;L.set(P,E)}return L}function re(I){s(1,x=Math.max(0,Math.min(g,x+I))),Fe()}function xl(I){s(1,x=+I.target.value),Fe()}function ge(I){I.key==="ArrowRight"&&re(1),I.key==="ArrowLeft"&&re(-1)}const Rl=()=>re(-100),gl=()=>re(-10),Ee=()=>re(-1),Ol=()=>re(1),wl=()=>re(10),Te=()=>re(100);return i.$$set=I=>{s(15,t=pa(pa({},t),Qo(I)))},i.$$.update=()=>{i.$$.dirty[0]&65538&&s(17,o=A[x]||[]),i.$$.dirty[0]&131072&&s(7,r=yr(o)),i.$$.dirty[0]&3&&s(6,c=x/g*100),i.$$.dirty[0]&2&&s(5,m=xe(x))},t=Qo(t),[g,x,C,F,X,m,c,r,y,oe,ie,Hl,Nl,re,xl,t,A,o,Rl,gl,Ee,Ol,wl,Te]}class vr extends Ui{constructor(t){super(),Wi(this,t,Cr,dr,zi,{},null,[-1,-1])}}const Dr=Object.freeze(Object.defineProperty({__proto__:null,default:vr,metadata:ua},Symbol.toStringTag,{value:"Module"}));export{Dr as _};
